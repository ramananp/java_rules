<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "sql-map-2.dtd">
<sqlMap namespace="AATA">
   	
   <!-- ********** START PICKLIST  **********-->
		<resultMap id="getPicklistsResult" class="com.jpmchase.aata.services.to.AATAPickListTO" groupBy="applicationId, pickListId">
		  <result property="pickListId" column="LOOKUP_TYP_CD" nullValue=""/> 
		  <result property="applicationId" column="APPL_NM" nullValue="" /> 
		  <result property="pickListMode" column="PICKLIST_MODE" jdbcType="NUMBER" javaType="int" nullValue=""/> 
		  <result property="values" resultMap="AATA.picklistMap"/>
		</resultMap>
		
		
		<resultMap id="picklistMap" class="com.jpmchase.aata.services.to.LookUpTO">
		  <result property="key" column="value" /> 
		  <result property="value" column="name"/>
		  <result property="description" column="status"/>
		</resultMap>
		
		
		<select id="GET_PICKLISTS" parameterClass="com.jpmchase.aata.services.to.AATAPickListInputTO" resultMap="getPicklistsResult">
			<dynamic prepend="">
			 	<isNotNull property="pickList">
			 		<iterate property="pickList" open="" close=""  conjunction="UNION">
			 			SELECT  
					        detl.LOOKUP_VAL_CD +' - ' + detl.LOOKUP_VAL_DESC_TX name,   
					        detl.LOOKUP_VAL_CD value,
					        detl.LOOKUP_STS_CD status,
					        detl.SORT_ORDER SORT_ORDR,
						  	detl.APPL_NM,
                        	detl.LOOKUP_TYP_CD,
                        	1 PICKLIST_MODE
					    FROM
					 		AT_LOOKUP_MSTR mstr,
					        AT_LOOKUP_DETL detl
					    WHERE   
					        mstr.LOOKUP_TYP_CD = detl.LOOKUP_TYP_CD AND
					        detl.DISP_FLG_IN = 'Y' AND
					        mstr.APPL_NM = #pickList[].applicationId# AND
					        mstr.LOOKUP_TYP_CD = #pickList[].pickListId#
					        
					     UNION 
					     
					     SELECT  
					        detl.LOOKUP_VAL_CD +' - ' + detl.LOOKUP_VAL_DESC_TX name,      
					        detl.LOOKUP_VAL_CD value,
					        detl.LOOKUP_STS_CD status,
					        detl.SORT_ORDER SORT_ORDR,
						  	detl.APPL_NM,
                        	detl.LOOKUP_TYP_CD,
                        	1 PICKLIST_MODE
					    FROM
					 		AT_LOOKUP_MSTR mstr,
					        AT_LOOKUP_DETL detl
						WHERE
					    	mstr.LOOKUP_TYP_CD = detl.LOOKUP_TYP_CD AND 
							detl.DISP_FLG_IN = 'Y' AND
					    	1=2
   
					</iterate>
				</isNotNull>
			</dynamic>
			ORDER BY APPL_NM, LOOKUP_TYP_CD,SORT_ORDER
		</select>		
		
		<!-- ********** END PICKLIST  *************-->
		
		
		
   <!-- ********** START COLMODELDATA  **********-->
		<resultMap id="getColModelDataResult" class="com.jpmchase.aata.services.to.AATAColModelTO">
		  <result property="attrId" column="ATTR_ID" nullValue=""/> 
		  <result property="attrName" column="ATTR_NM" nullValue="" />
		  <result property="name" column="ATTR_ID" nullValue="" />
		  <result property="type" column="DELV_INSTR_LVL" nullValue="" />
		  <result property="assetTypeCode" column="ASET_TYP_CD" nullValue=""/> 
		</resultMap>
		
		<select id="GET_COLMODELDATA" resultMap="getColModelDataResult">
			 			
			 			
			<![CDATA[
			
				
			SELECT DISTINCT insmap.ASET_TYP_CD , insmap.ATTR_ID, insattr.ATTR_NM, astyp.DELV_INSTR_LVL
				
  				FROM	AT_ASSET_DELV_INST_MAP insmap,
  						AT_DELV_INSTR_ATTR insattr,
  						AT_ASSET_TYPE astyp  						
  					
  				WHERE	astyp.ASET_TYP_CD = insmap.ASET_TYP_CD 
  				AND		insattr.ATTR_ID = insmap.ATTR_ID 
  				AND		insattr.ATTR_ID <> 10 
  				AND		((astyp.DELV_INSTR_LVL = 'IMNT' ) or (insmap.ASET_TYP_CD='320' and insmap.INT_EXT_IND='E' and insmap.FULL_PARTIAL_IND='F'))
  				
			]]>
			 		 
			
		</select>		
		
		<!-- ********** END COLMODELDATA  *************-->
			
</sqlMap>